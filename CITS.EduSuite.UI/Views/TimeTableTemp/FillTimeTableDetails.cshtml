@model CITS.EduSuite.Business.Models.ViewModels.TimeTableTempMasterViewModel
@using CITS.EduSuite.UI
@using CITS.EduSuite.Business.Models.ViewModels
<script src="~/Scripts/tinymce/tiny_mce.js"></script>
<div class="repeater col-12 px-1">

    @Html.HiddenFor(m => m.BranchKey)
    <table id="tblAttendance" class="table table-stripped table-bordered table-attendance">
        <thead class="thead-dark">
            <tr>

                <th>
                    @Html.Label(EduSuiteUIResources.ClassCode, htmlAttributes: new { @class = "form-label" })
                </th>

                @foreach (var item in (Model.WeeklyPeriods as List<SelectListModel>))
                {
                    <th class="active">
                        @item.Text
                    </th>
                }
            </tr>
        </thead>
        <tbody data-repeater-list>
            @{
                var index = 0;
            }
            @foreach (var classItem in (Model.ClassDetails as List<SelectListModel>))
            {
                <tr data-repeater-item>
                    <td class="py-0">
                        @classItem.Text
                    </td>
                    @foreach (var item in (Model.WeeklyPeriods as List<SelectListModel>))
                    {
                        <td class="p-0">
                            @{
                                var currItem = Model.TimeTableTempDetailsModel.Where(row => row.PeriodKey == item.RowKey && row.ClassDetailsKey == classItem.RowKey).FirstOrDefault() as TimeTableTempDetailsModel;
                            }
                            @if (currItem != null)
                            {
                                @Html.Hidden("[" + index + "].RowKey", currItem.RowKey)
                                @Html.Hidden("[" + index + "].ClassDetailsKey", classItem.RowKey)
                                @Html.Hidden("[" + index + "].PeriodKey", item.RowKey)
                                @Html.Hidden("[" + index + "].Day", currItem.Day)
                                @Html.DropDownList("[" + index + "].ToEmployeeKey", new SelectList(new List<SelectListModel>(), "RowKey", "Text"), new { @class = "form-control input-control w3-sand", @data_val = @currItem.ToEmployeeKey, @data_style = "btn-primary w3-sand" })
                                { index++; }
                            }
                        </td>

                    }
                </tr>

            }


        </tbody>
    </table>


</div>

<div class="col-12">
    <span class="text-danger"><strong> @Html.ValidationMessage("error_msg")</strong>  </span>
</div>
<script>
    $(document).ready(function () {
        AppCommon.FormatInputCase();
        $("[data-repeater-item]").each(function () {
            TimeTableTemp.GetEmployeeById(this);
        })
    });
</script>
