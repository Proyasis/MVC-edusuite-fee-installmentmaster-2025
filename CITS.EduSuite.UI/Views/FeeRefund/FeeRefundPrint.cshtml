@model CITS.EduSuite.Business.Models.ViewModels.FeeRefundPrintViewModel
@using CITS.EduSuite.Business.Models.ViewModels


@Scripts.Render("~/bundles/jquery")
<script src="~/CITSEduSuiteScripts/Common/AppCommon.js"></script>
<div id="dvPrintReciept" class="PrintReciept">

    <style>
        .PrintReciept {
            border: double 8px;
            border-color: #ad3a3a;
            border-radius: 5px;
        }

        .PrintReciept-Details {
            margin-left: 20px;
        }

        .HeaderLeft {
            padding-left: 38px;
        }

        .HeaderRight {
            position: relative;
            top: 70px;
            font-size: 16px;
            right: -74px;
        }

        .Companydetails {
            text-align: center;
            font-size: 16px;
        }

            .Companydetails .CompanyName {
                font-weight: bold;
                color: black;
                margin-bottom: 5px;
                text-transform: uppercase;
            }

            .Companydetails .RecieptHead {
                color: orange;
                font-weight: bold;
                margin: 7px 0px;
                font-size: 18px;
            }

            .Companydetails .CompanyAddress {
                margin: 0px 0px 0px;
                font-weight: bold;
                font-size: 13px;
            }



        .FeeDetails {
            margin-top: 15px;
        }

            .FeeDetails table {
                width: 95%;
                border: solid 1px;
                border-collapse: collapse;
                top: -30px;
                position: relative;
                margin-bottom: -29px;
                font-size: 15px;
            }

                .FeeDetails table th {
                    text-align: center;
                }

                .FeeDetails table tr th, .FeeDetails table tr, .FeeDetails table td {
                    border: 1px solid black;
                }

            .FeeDetails ul li {
                list-style: none;
            }

        .FeeDetails-Amount {
            text-align: right;
            padding-right: 5px;
        }

        .padding-None {
            padding: 0px;
        }


        /*new style*/


        .Content-left {
            width: 72%;
            font-size: 15px;
            margin-left: 19px;
        }

        .Content-lef1 .content-divleft {
            width: 20%;
            display: inline-block;
            font-weight: bold;
        }

        .Content-lef1 .content-divright {
            border-bottom: dotted 1px black;
            display: inline-block;
            width: 20%;
        }

        .Content-lef2 {
            margin-left: 49px;
            margin-top: 9px;
        }

        .content-div {
            margin: 6px 0px;
        }

        .Content-lef2 .content-div .content-divleft {
            width: 30%;
            display: inline-block;
            font-weight: bold;
        }

        .Content-lef2 .content-div .content-divright {
            display: inline-block;
            width: 65%;
            border-bottom: dotted 1px black;
        }

        .Content-right {
            width: 25%;
            font-size: 15px;
            margin-left: 19px;
            float: right;
            position: relative;
            top: -155px;
        }

            .Content-right .content-div .content-divleft {
                width: 24%;
                display: inline-block;
                font-weight: bold;
            }

            .Content-right .content-div .content-divright {
                display: inline-block;
                width: 68%;
                border-bottom: dotted 1px black;
            }

        .Contentfooter {
            font-size: 13px;
            font-weight: bold;
            margin: 10px 30px;
        }

            .Contentfooter .CasType {
                margin: 10px 0px;
                font-size: 18px;
                font-weight: 100;
            }

                .Contentfooter .CasType .CasType-left {
                    width: 52%;
                    display: inline-block;
                }

            .Contentfooter .content-div .content-divleft {
                width: 17%;
                display: inline-block;
            }

            .Contentfooter .content-div .content-divright {
                display: inline-block;
                width: 81%;
                border-bottom: dotted 1px black;
            }

            .Contentfooter .content-div .content-DivCheckboxleft {
                width: 17%;
                display: inline-block;
            }

            .Contentfooter .content-div .content-DivCheckbox {
                display: inline-block;
                width: 5%;
            }


            .Contentfooter .content-div .content-DivCheckboxright {
                display: inline-block;
                font-size: 14px;
                width: 45%;
                border-bottom: dotted 1px black;
                text-transform: capitalize;
                word-break: break-all;
                font-weight: bold;
            }

        .Footer-sign {
            text-align: right;
            margin-top: 35px;
        }

            .Footer-sign .Footer-signright {
                border-top: solid 2px;
                text-align: center;
                padding: 5px 29px 0px;
            }

        span.Footer-signleft {
            text-align: left !important;
            float: left;
        }

        .FBoldNone {
            font-weight: 100;
        }


        .table-inner {
            width: 100% !important;
            border: none !important;
            margin: 0px !important;
            top: 0 !important;
            text-align: center !important;
        }

        .displaynone {
            display: none;
        }
    </style>
    <div style="height: 158px;    width: 100%;">
        <div style="float:left;width:20%;text-align: right;">

            @*<img src="../../UploadFiles/Company/Logo/SN_College_logo.jpg" style="height:100px" />*@

            <img src="../../UploadFiles/Company/Logo/logo.png" style="height: 76px; width: 100px; top: 20px; position: relative;" />

        </div>
        <div style="float:left;width:62%" class="Companydetails">
            <h3 class="CompanyName">@Model.CompanyName</h3>
            <p class="CompanyAddress">@Model.CompanyAddress ,@Model.CityName </p>
            <p class="CompanyAddress">@Model.AddressLine2 @Model.PostalCode</p>
            <p class="CompanyAddress">Ph: @Model.PhoneNumber1</p>
            <h5 class="RecieptHead">Fee Refund Voucher</h5>
        </div>

    </div>
    @*<div class="rows">
            <div class="Companydetails">
                <h3 class="CompanyName">@Model.CompanyName</h3>
                <p class="CompanyAddress">@Model.CompanyAddress, Ph: @Model.PhoneNumber1 </p>
                <p class="CompanyAddress">@Model.CityName @Model.PostalCode</p>
                <h5 class="RecieptHead">Fee Receipt</h5>
            </div>
        </div>*@


    <div class="rows Content">
        <div class="Content-left">

            @*<div class="Content-lef1">
                    <div class="content-divleft">GSTIN No</div><span>:</span>
                    <div class="content-divright">@Model.GSTINNumber</div>
                </div>*@
            <div class="Content-lef1">
                <div class="content-divleft">Voucher No </div><span>:</span>
                <div class="content-divright">@Model.FeeRefundViewModel.VoucherNo</div>
            </div>

            <div class="Content-lef2">
                <div class="content-div">
                    <div class="content-divleft">Admission No</div><span>:</span>
                    <div class="content-divright" style="width:33%">@Model.AdmissionNo</div>
                </div>
                <div class="content-div">
                    <div class="content-divleft">Name</div><span>:</span>
                    <div class="content-divright">@Model.StudentName</div>
                </div>
                <div class="content-div displaynone">
                    <div class="content-divleft">Mobile No</div><span>:</span>
                    @*<div class="content-divright">@Model.mobi</div>*@
                </div>
                <div class="content-div">
                    <div class="content-divleft">Program</div><span>:</span>
                    <div class="content-divright">@Model.ProgramName</div>
                </div>
                @*@if (Model.UniversityName != null)
                    {
                        <div class="content-div">
                            <div class="content-divleft">University</div><span>:</span>
                            <div class="content-divright">@Model.UniversityName</div>
                        </div>
                    }*@
            </div>
        </div>
        <div class="Content-right">
            <div class="content-div">
                <div class="content-divleft">Date</div><span>:</span>
                <div class="content-divright">@string.Format("{0:dd/MM/yyyy}", Model.FeeRefundViewModel.RefundDate)</div>
            </div>
            <div class="content-div displaynone">
                <div class="content-divleft">Place</div><span>:</span>
                <div class="content-divright">@Model.CityName </div>
            </div>


        </div>
    </div>

    <div class="row FeeDetails">
        <center>
            <table>
                <thead>
                    <tr>

                        <th rowspan="2">Fee Descreption</th>
                        <th colspan="2">Amount</th>
                    </tr>
                    <tr>
                        <th>Rs.</th>
                        <th>Ps.</th>
                    </tr>
                </thead>

                <tbody>

                    <tr>
                        <td>
                            <ul>
                                @foreach (var item in Model.FeeRefundViewModel.FeeRefundDetails)
                                {


                                <li>
                                    @item.FeeTypeName
                                    @if (item.FeeYear != null)
                                    {
                                        <span>(</span> @item.FeeYearText<span>)</span>
                                    }
                                    Receipt No :  @item.RecieptNo
                                </li>

                                }

                            </ul>

                        </td>

                        <td>
                            <ul class="FeeDetails-Amount">
                                @foreach (var item in Model.FeeRefundViewModel.FeeRefundDetails)
                                {
                                    <li>@string.Format("{0:G29}", item.ReturnAmount)</li>

                                }

                            </ul>
                        </td>
                        <td></td>
                    </tr>

                </tbody>
                <tfoot>
                    <tr>
                        <th rowspan="2" class="FeeDetails-Amount" style="text-align:right;padding-right:50px;">Total</th>

                    </tr>
                    <tr>
                        <th id="totalAmount" class="FeeDetails-Amount" style="text-align:right">@string.Format("{0:G29}", Model.FeeRefundViewModel.RefundAmount)</th>
                        <th class="FeeDetails-Amount"></th>
                    </tr>
                </tfoot>
            </table>
        </center>
    </div>


    <div class="Contentfooter">
        <div class="content-div">
            <div class="content-divleft">Amount in Words</div><span>:</span>
            <div class="content-divright" id="amountWords"></div>
        </div>
        <div class="content-div CasType">
            <div class="CasType-left">
                @foreach (var item in Model.FeeRefundViewModel.PaymentModes)
                {
                    if (item.RowKey == Model.FeeRefundViewModel.PaymentModeKey)
                    {
                        <div class="content-DivCheckbox">&#9745;</div>
                        <div class="content-DivCheckboxleft">@item.Text</div>

                    }
                    else
                    {
                        <div class="content-DivCheckbox">&#x2610;</div>
                        <div class="content-DivCheckboxleft">@item.Text</div>

                    }
                }


            </div>
            @if (Model.FeeRefundViewModel.PaymentModeKey == DbConstants.PaymentMode.Cheque)
            {

                <div class="content-DivCheckboxright">Check No: <span class="FBoldNone"> @Model.FeeRefundViewModel.ChequeOrDDNumber</span><span style="padding-right:11px">,</span>Check Date: <span class="FBoldNone"> @string.Format("{0:dd/MM/yyyy}", Model.FeeRefundViewModel.ChequeClearanceDate)</span></div>

            }
            @*else if (Model.ApplicationFeePaymentViewModel.PaymentModeKey == DbConstants.PaymentMode.Card)
                {
                    <div class="content-DivCheckboxright">Card No: <span class="FBoldNone"> @Model.ApplicationFeePaymentViewModel.CardNumber</span></div>
                }*@
            else if (Model.FeeRefundViewModel.PaymentModeKey == DbConstants.PaymentMode.Bank)
            {
                <div class="content-DivCheckboxright">Bank Account: <span class="FBoldNone"> @Model.FeeRefundViewModel.BankAccountName</span></div>
            }

        </div>

        <div class="Footer-sign">
            <span class="Footer-signleft">Fee once paid is not refundable under any circumstances</span>   <span class="Footer-signright">Authorized signatory</span>
        </div>
    </div>
</div>
<script>
    $(document).ready(function () {

        //$("#amountWords").html(AppCommon.AmounToWords($("#totalAmount").html()))
        $("#amountWords").html(convertNumberToWords($("#totalAmount").html()))
        setTimeout(function () {
            window.print();
            window.close()
            //printDiv()
        }, 500)
        $("#btnPrintReceipt").on("click", function () {
            window.print();
            window.close()
            //printDiv()
        })

    });


    //function printDiv(div) {
    //    var mode = 'iframe'; //popup
    //    var close = mode == "popup";
    //    var options = { mode: mode, popClose: close };
    //    $(div).printArea(options);
    //}

    function convertNumberToWords(amount) {
        
        var words = new Array();
        words[0] = '';
        words[1] = 'One';
        words[2] = 'Two';
        words[3] = 'Three';
        words[4] = 'Four';
        words[5] = 'Five';
        words[6] = 'Six';
        words[7] = 'Seven';
        words[8] = 'Eight';
        words[9] = 'Nine';
        words[10] = 'Ten';
        words[11] = 'Eleven';
        words[12] = 'Twelve';
        words[13] = 'Thirteen';
        words[14] = 'Fourteen';
        words[15] = 'Fifteen';
        words[16] = 'Sixteen';
        words[17] = 'Seventeen';
        words[18] = 'Eighteen';
        words[19] = 'Nineteen';
        words[20] = 'Twenty';
        words[30] = 'Thirty';
        words[40] = 'Forty';
        words[50] = 'Fifty';
        words[60] = 'Sixty';
        words[70] = 'Seventy';
        words[80] = 'Eighty';
        words[90] = 'Ninety';
        amount = amount.toString();
        var atemp = amount.split(".");
        var number = atemp[0].split(",").join("");
        var n_length = number.length;
        var words_string = "";
        if (n_length <= 9) {
            var n_array = new Array(0, 0, 0, 0, 0, 0, 0, 0, 0);
            var received_n_array = new Array();
            for (var i = 0; i < n_length; i++) {
                received_n_array[i] = number.substr(i, 1);
            }
            for (var i = 9 - n_length, j = 0; i < 9; i++, j++) {
                n_array[i] = received_n_array[j];
            }
            for (var i = 0, j = 1; i < 9; i++, j++) {
                if (i == 0 || i == 2 || i == 4 || i == 7) {
                    if (n_array[i] == 1) {
                        n_array[j] = 10 + parseInt(n_array[j]);
                        n_array[i] = 0;
                    }
                }
            }
            value = "";
            for (var i = 0; i < 9; i++) {
                if (i == 0 || i == 2 || i == 4 || i == 7) {
                    value = n_array[i] * 10;
                } else {
                    value = n_array[i];
                }
                if (value != 0) {
                    words_string += words[value] + " ";
                }
                if ((i == 1 && value != 0) || (i == 0 && value != 0 && n_array[i + 1] == 0)) {
                    words_string += "Crores ";
                }
                if ((i == 3 && value != 0) || (i == 2 && value != 0 && n_array[i + 1] == 0)) {
                    words_string += "Lakhs ";
                }
                if ((i == 5 && value != 0) || (i == 4 && value != 0 && n_array[i + 1] == 0)) {
                    words_string += "Thousand ";
                }
                if (i == 6 && value != 0 && (n_array[i + 1] != 0 && n_array[i + 2] != 0)) {
                    words_string += "Hundred and ";
                } else if (i == 6 && value != 0) {
                    words_string += "Hundred ";
                }
            }
            words_string = words_string.split("  ").join(" ");
        }
        return words_string;
    }
</script>

